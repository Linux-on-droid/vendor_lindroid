# Container specific configuration
lxc.rootfs.path = overlayfs:/data/lindroid/lxc/rootfs_ro:/data/lindroid/lxc/container/default/rootfs
lxc.uts.name = default

# Network configuration
lxc.net.0.type = none

# Android mounts
lxc.mount.entry = /sdcard mnt/sdcard none bind,optional,rw,create=dir

# Allow for 1024 pseudo terminals
lxc.pty.max = 1024

# CGroup allowlist
lxc.cgroup.devices.deny = a
## Allow any mknod (but not reading/writing the node)
lxc.cgroup.devices.allow = c *:* m
lxc.cgroup.devices.allow = b *:* m
## Allow specific devices
### /dev/null
lxc.cgroup.devices.allow = c 1:3 rwm
### /dev/zero
lxc.cgroup.devices.allow = c 1:5 rwm
### /dev/full
lxc.cgroup.devices.allow = c 1:7 rwm
### /dev/tty
lxc.cgroup.devices.allow = c 5:0 rwm
### /dev/console
lxc.cgroup.devices.allow = c 5:1 rwm
### /dev/ptmx
lxc.cgroup.devices.allow = c 5:2 rwm
### /dev/random
lxc.cgroup.devices.allow = c 1:8 rwm
### /dev/urandom
lxc.cgroup.devices.allow = c 1:9 rwm
### /dev/pts/*
lxc.cgroup.devices.allow = c 136:* rwm
### fuse
lxc.cgroup.devices.allow = c 10:229 rwm

lxc.environment = CGROUP_MANAGER=systemd

lxc.mount.entry = cgroup2 /sys/fs/cgroup cgroup2 defaults 0 0

lxc.mount.entry = /proc proc none bind,optional,rw,create=dir
lxc.mount.entry = /tmp tmp none bind,optional,rw,create=dir
lxc.mount.entry = /vendor vendor none bind,optional,rw,create=dir
lxc.mount.entry = /system system none bind,optional,rw,create=dir
lxc.mount.entry = /system_ext system_ext none bind,optional,rw,create=dir
lxc.mount.entry = /apex apex none rbind,optional,rw,create=dir

lxc.mount.entry = /dev/socket dev/socket none bind,optional,rw,create=dir
lxc.mount.entry = /dev/__properties__ dev/__properties__ none bind,optional,rw,create=dir
lxc.mount.entry = /dev/binder dev/binder none bind,optional,rw,create=file
lxc.mount.entry = /dev/hwbinder dev/hwbinder none bind,optional,rw,create=file
lxc.mount.entry = /dev/vndbinder dev/vndbinder none bind,optional,rw,create=file
lxc.mount.entry = /dev/pmsg0 dev/pmsg0 none bind,optional,rw,create=file
lxc.mount.entry = /dev/ashmem dev/ashmem none bind,optional,rw,create=file
lxc.mount.entry = /dev/ion dev/ion none bind,optional,create=file
lxc.mount.entry = /dev/input dev/input none rbind,optional,rw,create=dir
lxc.mount.entry = /dev/tty0 dev/tty0 none bind,optional,rw,create=file
lxc.mount.entry = /dev/tty1 dev/tty1 none bind,optional,rw,create=file
lxc.mount.entry = /dev/tty2 dev/tty2 none bind,optional,rw,create=file
lxc.mount.entry = /dev/tty3 dev/tty3 none bind,optional,rw,create=file
lxc.mount.entry = /dev/tty4 dev/tty4 none bind,optional,rw,create=file
lxc.mount.entry = /dev/tty5 dev/tty5 none bind,optional,rw,create=file
lxc.mount.entry = /dev/tty6 dev/tty6 none bind,optional,rw,create=file
lxc.mount.entry = /dev/tty7 dev/tty7 none bind,optional,rw,create=file
lxc.mount.entry = selinuxfs sys/fs/selinux selinuxfs optional 0 0
lxc.mount.entry = /dev/binderfs dev/binderfs bind bind,create=dir,optional 0 0

# Hack, bind mount patched libc inside container to avoid errors
lxc.mount.entry = /system/lindroid/libc.so apex/com.android.runtime/lib64/bionic/libc.so none bind,optional,ro,create=file

# GPU devices
lxc.mount.entry = /dev/kgsl-3d0 dev/kgsl-3d0 none bind,optional,create=file
lxc.mount.entry = /dev/mali0 dev/mali0 none bind,optional,create=file
